<!DOCTYPE html>
<html lang="en">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<head>
    <meta charset="UTF-8">
    <title>Speech Emotion Recognition</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <body>
        <div style="width:100%;display:flex;justify-content:center;gap:2.5rem;margin-top:2.5rem;margin-bottom:1.5rem;flex-wrap:wrap;">
        <!-- Microphone SVG -->
        <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
            <ellipse cx="40" cy="32" rx="18" ry="24" fill="#ff7eb3" opacity="0.8"/>
            <rect x="32" y="56" width="16" height="18" rx="8" fill="#ffd54f"/>
            <rect x="36" y="66" width="8" height="10" rx="4" fill="#ff7eb3"/>
            <rect x="36" y="12" width="8" height="40" rx="4" fill="#fff"/>
            <ellipse cx="40" cy="32" rx="12" ry="16" fill="#fff"/>
            <ellipse cx="40" cy="32" rx="8" ry="12" fill="#ffe082"/>
        </svg>
        <!-- Waveform SVG -->
        <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
            <rect x="10" y="40" width="6" height="20" rx="3" fill="#43e97b"/>
            <rect x="22" y="30" width="6" height="40" rx="3" fill="#ff7eb3"/>
            <rect x="34" y="20" width="6" height="60" rx="3" fill="#ffd54f"/>
            <rect x="46" y="30" width="6" height="40" rx="3" fill="#43e97b"/>
            <rect x="58" y="40" width="6" height="20" rx="3" fill="#ff7eb3"/>
        </svg>
        <!-- Emoji SVG -->
        <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
            <circle cx="40" cy="40" r="36" fill="#ffe082" stroke="#ffb300" stroke-width="4"/>
            <ellipse cx="28" cy="36" rx="4" ry="6" fill="#fff"/>
            <ellipse cx="52" cy="36" rx="4" ry="6" fill="#fff"/>
            <ellipse cx="28" cy="36" rx="2" ry="3" fill="#333"/>
            <ellipse cx="52" cy="36" rx="2" ry="3" fill="#333"/>
            <path d="M28 54 Q40 64 52 54" stroke="#ff7eb3" stroke-width="3" fill="none" stroke-linecap="round"/>
        </svg>
    </div>

    <section style="
    width: 100%;
    margin: 2.5rem 0 1.5rem 0;
    padding: 0 0.5em;
    color: #fff;
    font-size: 1.25rem;
    font-family: 'Montserrat', 'Segoe UI', Arial, sans-serif;
    text-align: center;
    line-height: 1.7;
    letter-spacing: 0.02em;
    background: none;
    box-shadow: none;
    border: none;
    text-shadow: 0 2px 8px #0003;
">
    <span style="font-size:2.2rem; font-weight:700; letter-spacing:0.05em; color:#ffe082; display:block; margin-bottom:0.5em;">
        Welcome to <span style="color:#fff176;">Speech Emotion Recognition</span>!
    </span>
    <span>
        This interactive web app lets you <strong style="color:#ffd54f;">discover the emotion behind your voice</strong>.<br>
        Simply <strong>upload an audio file</strong> or <strong>record your voice live</strong>, and our intelligent system will analyze your speech to predict the underlying emotion‚Äîeven complex, real-life feelings like <em style="color:#b2ff59;">bittersweet</em> or <em style="color:#b2ff59;">anxious excitement</em>.<br><br>
    </span>
    <span style="font-size:1.1rem;">
        <strong style="color:#ffb300;">Why use this?</strong>
        Whether you‚Äôre curious about your own emotions, want to improve communication, or just have fun exploring the science of speech, this tool is here for you.<br>
        <span style="color:#ffd54f;">Enjoy a seamless, modern experience</span> and see how technology can help us understand feelings in a whole new way!
    </span>
</section>

    <!-- Main App Container -->
    <div class="glass-card">
        <!-- ...existing content... -->
    <style>
        body {
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        .glass-card {
            background: rgba(255,255,255,0.15);
            box-shadow: 0 8px 32px 0 rgba(31,38,135,0.37);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.18);
            padding: 2rem 2.5rem;
            margin: 2rem 0;
            width: 90%;
            max-width: 420px;
            text-align: center;
        }
        h1 {
            font-size: 2.5rem;
            color: #fff;
            margin-bottom: 0.5em;
            letter-spacing: 2px;
            text-shadow: 0 2px 8px #0002;
        }
        label, h2 {
            color: #fff;
            font-weight: 600;
            margin-bottom: 1em;
        }
        input[type="file"] {
            margin: 1em 0;
            padding: 0.5em;
            border-radius: 8px;
            border: none;
            background: #fff9;
        }
        button, .mic-button {
            background: linear-gradient(90deg, #ff758c 0%, #ff7eb3 100%);
            color: #fff;
            border: none;
            padding: 0.8em 2em;
            border-radius: 30px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin: 1em 0.5em;
            box-shadow: 0 2px 8px #0002;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover, .mic-button:hover {
            transform: scale(1.07);
            box-shadow: 0 4px 16px #0003;
        }
        .mic-anim {
            display: inline-block;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }
        .waveform {
            width: 100%;
            height: 40px;
            margin: 1em 0;
            background: linear-gradient(90deg, #ff758c 0%, #ff7eb3 100%);
            border-radius: 10px;
            overflow: hidden;
            display: none;
        }
        .wave-bar {
            height: 100%;
            width: 5%;
            background: #fff;
            display: inline-block;
            margin: 0 1px;
            border-radius: 8px;
            animation: wave 1s infinite linear;
        }
        @keyframes wave {
            0%, 100% { height: 30%; }
            50% { height: 100%; }
        }
        .audio-player {
            margin-top: 1em;
        }
        @media (max-width: 600px) {
            .glass-card { padding: 1rem; }
            h1 { font-size: 2rem; }
        }
    </style>
</head>
<!-- Loading Spinner Overlay -->
<div id="loading-overlay" style="
    display:none;
    position:fixed;
    top:0; left:0; width:100vw; height:100vh;
    background:rgba(0,0,0,0.35);
    z-index:9999;
    align-items:center;
    justify-content:center;
">
    <div style="
        width:80px; height:80px; border-radius:50%;
        border:8px solid #ff7eb3;
        border-top:8px solid #43e97b;
        animation: spin 1s linear infinite;
        margin:auto;
    "></div>
</div>
<style>
@keyframes spin {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(360deg);}
}
</style>

<body>
    <!-- Replace your .glass-card div and its content with this -->
<div class="crazy-glass-card">
    <h1><span style="color:#ffeb3b;">Speech</span> <span style="color:#fff;">Emotion</span> <span style="color:#ff7eb3;">Recognition</span></h1>
    <p class="subtitle">Let your voice reveal your feelings!</p>
    <form action="/predict" method="post" enctype="multipart/form-data" class="crazy-form">
        <label for="audio">üéµ <b>Upload Audio File</b>:</label>
        <input type="file" name="audio" id="audio" accept="audio/*">
        <button type="submit">üîÆ Predict Emotion</button>
    </form>
    <div class="divider"><span>OR</span></div>
    <h2 class="live-title">üéôÔ∏è Record Live Audio</h2>
    <button id="startRecord" class="mic-button">
        <span class="mic-anim">üé§</span> Start Recording
    </button>
    <button id="stopRecord" class="mic-button" style="display:none;background:#ff758c;">
        ‚èπÔ∏è Stop
    </button>
    <div class="waveform" id="waveform">
        <div class="wave-bar" style="animation-delay:0s"></div>
        <div class="wave-bar" style="animation-delay:0.1s"></div>
        <div class="wave-bar" style="animation-delay:0.2s"></div>
        <div class="wave-bar" style="animation-delay:0.3s"></div>
        <div class="wave-bar" style="animation-delay:0.4s"></div>
        <div class="wave-bar" style="animation-delay:0.5s"></div>
        <div class="wave-bar" style="animation-delay:0.6s"></div>
        <div class="wave-bar" style="animation-delay:0.7s"></div>
    </div>
    <audio id="audioPlayback" controls style="display:none;" class="audio-player"></audio>
    <form id="uploadForm" action="/predict_live" method="post" enctype="multipart/form-data" style="display:none;">
        <input type="file" id="audioBlob" name="audio" style="display:none;">
        <button type="submit" class="mic-button" style="background:#4caf50;">Submit Recording</button>
    </form>
</div>
<script>
    let mediaRecorder, audioChunks = [];
    const startBtn = document.getElementById('startRecord');
    const stopBtn = document.getElementById('stopRecord');
    const waveform = document.getElementById('waveform');
    const audioPlayback = document.getElementById('audioPlayback');
    const uploadForm = document.getElementById('uploadForm');
    const audioBlobInput = document.getElementById('audioBlob');

    startBtn.onclick = async function(e) {
        e.preventDefault();
        audioChunks = [];
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        mediaRecorder = new MediaRecorder(stream);
        mediaRecorder.start();
        waveform.style.display = 'block';
        startBtn.style.display = 'none';
        stopBtn.style.display = 'inline-block';

        mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
        mediaRecorder.onstop = e => {
            waveform.style.display = 'none';
            const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
            const audioUrl = URL.createObjectURL(audioBlob);
            audioPlayback.src = audioUrl;
            audioPlayback.style.display = 'block';
            uploadForm.style.display = 'block';

            // Prepare file input for form submission
            const file = new File([audioBlob], "recorded_audio.webm", { type: "audio/webm" });
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            audioBlobInput.files = dataTransfer.files;
        };
    };

    stopBtn.onclick = function(e) {
        e.preventDefault();
        mediaRecorder.stop();
        stopBtn.style.display = 'none';
        startBtn.style.display = 'inline-block';
    };
    </script>
    <script>
document.querySelectorAll('form').forEach(form => {
    form.addEventListener('submit', function() {
        document.getElementById('loading-overlay').style.display = 'flex';
    });
});
</script>
</body>
</html>